unit UCHelicoptero;

interface
uses   Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.ExtCtrls, System.ImageList,
  Vcl.ImgList ;

type
Pos = Record
    x : integer;
    y : integer;
 End;
Direcciones = Record
    izquierda : Boolean;
    derecha : Boolean;
    superior : Boolean;
    inferior : Boolean;
 End;
  Helicoptero = class

    private
       v1, v2, v3, v4 : Pos;
       velocidad : integer;
       Direccion : Direcciones;
       helicopteroTIL: TImageList;
       TImageListCant:integer;
       visible : boolean;
    public
    constructor crear; overload;
    constructor crear(Helicoptero: TImageList; x, y, velocidad : integer); overload;
    procedure moverse(key :word);
    procedure Nomoverse(key :word);
    procedure teMOviste();
    procedure dibujar(t:TCanvas);
    procedure setX(x : integer);
    function getX(): integer;
    procedure setPos(x, y: integer); overload ;
    procedure setPos(x, y: integer; var vertice:Pos); overload;
  end;

implementation

{ Helicoptero }

constructor Helicoptero.crear;
begin
  v1.x := 0;
  v1.y := 0;
  Direccion.izquierda := false;
  Direccion.superior := false;
  Direccion.derecha := false;
  Direccion.inferior := false;
end;

constructor Helicoptero.crear(Helicoptero: TImageList; x, y, velocidad: integer);
begin
  self.helicopteroTIL := Helicoptero;
  self.setPos(x, y);
  Direccion.izquierda := false;
  Direccion.superior := false;
  Direccion.derecha := false;
  Direccion.inferior := false;
  TImageListCant := 0;
  visible := true;
  self.velocidad := velocidad;
//  helicopteroTIL.GetBitmap()
end;

procedure Helicoptero.dibujar(t: TCanvas);
begin
   if (visible) then
   begin
    helicopteroTIL.Draw(t, v1.x, v2.y,TImageListCant); //0.1.2
    TImageListCant := (TImageListCant+1) mod 3;
   end;

end;

function Helicoptero.getX: integer;
begin
  result := Self.v1.x;
end;

procedure Helicoptero.moverse(key: word);
begin
  case key of

   37:  begin  //izquierda
          Direccion.izquierda := true;
        end;

   38:  begin  //superior
          Direccion.superior := true;
        end;

   39:  begin  //derecha

           Direccion.derecha := true;
        end;


   40:  begin  //inferior
          Direccion.inferior := true;
        end;


   32:  begin  //espacio

        end;

 end;
end;

procedure Helicoptero.Nomoverse(key: word);
begin
     case key of

   37:  begin  //izquierda
          Direccion.izquierda := false;
        end;

   38:  begin  //superior
          Direccion.superior := false;
        end;

   39:  begin  //derecha
           Direccion.derecha := false;
        end;


   40:  begin  //inferior
          Direccion.inferior := false;
        end;


   32:  begin  //espacio

        end;

 end;
end;

procedure Helicoptero.setPos(x, y: integer; var vertice: Pos);
begin
  vertice.x := x;
  vertice.y := y;
end;

procedure Helicoptero.setPos(x, y: integer);
begin
  v1.x := x;
  v2.y := y;
end;

procedure Helicoptero.setX(x: integer);
begin
  self.v1.x := x;
end;

procedure Helicoptero.teMOviste;
begin


  if (Direccion.izquierda)and(v1.x > 0) then
    dec(v1.x, velocidad); //x := x - velocidad
  if (Direccion.derecha) then
    inc(v1.x, velocidad);
  if (Direccion.superior) and (v1.y > 0) then
    dec(v1.y, velocidad);
  if (Direccion.inferior) then
    inc(v1.y, velocidad);
//
//  if x > 500 then
//  begin
//    visible := false;
//  end else
//  visible := true;
end;

end.
